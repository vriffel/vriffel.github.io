[["index.html", "Modelo Auto-regressivo Integrado de Médias Móveis para a temperatura média anual nos anos de 1869-2019 do Central Park Prefácio", " Modelo Auto-regressivo Integrado de Médias Móveis para a temperatura média anual nos anos de 1869-2019 do Central Park Ana Rosária Zucon Vinicius Ricardo Riffel Prefácio Esse trabalho foi desenvolvimento na disciplina CE222 (Processos Estocásticos Aplicados) da UFPR, ministrada pelo professor Benito Olivares Aguilera. Foi proposto aos alunos fazer uma aplicação de algum tipo de processo estocástico (cadeias de Markov, teoria de filas etc) em dados obtidos pelos próprios alunos. Nós encontramos dados referentes às temperaturas médias anuais de 1869 até 2019 do Central Park, em Nova Iorque. Para avaliar o comportamento dos dados, aplicamos modelos para séries temporais. Os dados podem ser acessados pelo link: https://www.weather.gov/media/okx/Climate/CentralPark/monthlyannualtemp.pdf. "],["introdução.html", "1 Introdução", " 1 Introdução Nas últimas décadas, a discussão sobre mudanças climáticas vem ganhando cada vez mais espaço. Nesse contexto, o entendimento de uma série histórica climática é de suma importância, a fim de prever tendências e mudanças nos valores de temperatura e precipitação, por exemplo. Afinal, a habilidade de antecipar como o clima irá mudar de um ano para o outro, possibilita melhor gerenciamento da agricultura, recursos hídricos e atividade pesqueira, além da possibilidade de contribuição relevante nos campos dos transportes, abastecimento, turismo e lazer (Silva, Guimarães, and Tavares (2008)). Dentre diversos métodos para análises climáticas, a utilização de séries temporais se destaca pois, com base em métodos estatísticos, permite-nos a antecipar como o clima poderá se alterar de um período para outro. Uma série temporal é um processo estocástico realizado sequencialmente ao longo do tempo, as quais possuem dependência temporal, sendo um dos objetivos de o estudo de séries temporais analisar e modelar esta dependência. A ordem de uma série temporal é o número de tempos anteriores em que a série é autocorrelacionada. Um dos modelos existentes para previsão de séries temporais é o Auto-Regressive Integrated Moving Average (ARIMA). Esse modelo é utilizando amplamente por diversas áreas de estudo (Ariyo, Adewumi, and Ayo (2014); Pai and Lin (2005); Benvenuto et al. (2020); Chen, Yuan, and Shu (2008)) para realizar previsões de preços, demandas de produtos, clima, entre outros. Esse modelo funciona como versões ajustadas de modelos de passeio aleatório, adicionando-se defasagens das séries diferenciadas e/ou defasagens dos erros de previsão à previsão equação, a fim de remover autocorrelação dos erros de previsão. Inserido neste contexto, o objetivo deste trabalho foi analisar a previsão das temperaturas médias anuais de Central Park (Nova York) utilizando método quantitativo ARIMA. Especificamente também se objetiva a análise de tendência de aumento (ou diminuição) das temperaturas médias anuais com base nesse método. "],["sec-materias.html", "2 Metodologia 2.1 Processos estocásticos 2.2 Modelos para séries temporais", " 2 Metodologia Para utilizar séries temporais é necessário entender processos estocásticos, visto que um processo estocástico é uma coleção de variáveis aleatórias que, em geral, são utilizadas para estudar a evolução de fenômenos que são observados ao longo do tempo (Resende (2016)). 2.1 Processos estocásticos Um processo estocástico é uma função aleatória \\(Y_t\\) que evolui no tempo (e/ou no espaço), definida sob um espaço de probabilidades. Mais precisamente, um processo estocástico é uma família \\(Y=\\{Y(t), t \\in T\\}\\) tal que para cada \\(t\\) pertencente a \\(\\rm I\\!R\\), \\(Y(t)\\) é uma variável aleatória. Se \\(T=\\{1, \\ldots, t\\}\\), diz-se que o processo é de parâmetro discreto e é denotado por \\(Y_t\\) . Se \\(T\\) pertence a \\(\\rm I\\!R\\), diz-se que o processo é de parâmetro contínuo e é denotado por \\(Y(t)\\). O conceito de processos estocásticos é utilizado para descrever situações que não podem ser escritas com métodos determinísticos. Essas situações referem-se a processos em que dado uma condição inicial, essa pode evoluir de forma a percorrer inúmeras trajetórias possíveis (Faria (2015)). Nesse contexto, as séries temporais podem descrever e fazer previsões dessas situações. 2.2 Modelos para séries temporais A análise de séries temporais tem como objetivo principal a realização da previsão, e, para isso, diversos modelos podem ser ajustados, tendo como base a função de autocorrelação. O conceito de autocorrelação pode ser descrito, basicamente como a medição da correlação entre as observações de uma mesma variável em diferentes horizontes de tempo (Ehlers (2005)). Assim, com base no mesmo autor, dadas \\(n\\) observações \\(x_1, \\ldots, x_n\\) de uma série temporal discreta podemos formar os pares \\((x_1, x_2), \\ldots,(x_{n-1}, x_n)\\). Considerando \\(x_1, \\ldots, x_{n-1}\\) e \\(x_2, \\ldots, x_n\\) como duas variáveis o coeficiente de correlação entre \\(x_t\\) e \\(x_{t+1}\\) é dado por: \\[\\begin{equation*} r_k = \\frac{\\sum_{t=1}^{n-k} (x_t - \\bar{x})(x_{t+k} - \\bar{x})}{\\sum_{t=1}^{n}(x_t - \\bar{x})^2} \\end{equation*}\\] Dentro desse contexto, há diversos métodos que podem ser utilizados, e, serão descritos na sequência. Um modelo \\(Y_t\\) é chamado auto-regressivo de ordem \\(p\\), denotado por AR(\\(p\\)), se: \\[\\begin{equation} Y_t = c + \\sum_{t=1}^{p} \\phi_i Y_{t-i} + \\varepsilon_t \\hspace{0.3cm} t=p+1,p+2,\\ldots,n. \\tag{2.1} \\end{equation}\\] em que \\(Y_t\\) é um processo estocástico estacionário, \\(\\varepsilon_t\\) é um termo de erro, \\(c\\) e \\(\\phi_i\\) são os parâmetros do modelo. Os modelos AR podem ser usados como modelos se for razoável assumir que o valor atual de uma série temporal depende do seu passado adicionado por um erro aleatório. Outro modelo amplamente utilizado na análise de séries temporais são os modelos de médias móveis com ordem \\(q\\), denotado por \\(MA(q)\\), definidos por: \\[\\begin{equation} Y_t = \\mu + \\sum_{i=1}^{q} \\theta_{i} \\epsilon_{t-i} + \\varepsilon_t \\hspace{0.3cm} t=q+1,q+2,\\ldots,n. \\tag{2.2} \\end{equation}\\] em que \\(\\epsilon_t\\) é o erro no tempo \\(t\\), \\(\\varepsilon_t\\) é um termo de erro, \\(\\mu\\) e \\(\\theta_i\\) são os parâmetros do modelo. Combinando as Equações (2.1) e (2.2) temos o modelo ARMA (Autoregressive Moving Average). Eles são definidos por equações diferenciais lineares com coeficientes constantes e desempenham um papel fundamental na modelagem de dados de séries temporais Amaro et al. (2017). Ele é composto por composto de uma parte auto-regressiva variável, explicado pelo comportamento passado da própria variável, e uma parte de médias móveis, explicado pelos distúrbios de períodos anteriores Pinto et al. (2008), e, algebricamente é dado por: \\[\\begin{align*} Y_t = c + \\sum_{t=1}^{p} \\phi_i Y_{t-i} + \\sum_{i=1}^{q} \\theta_{i} \\epsilon_{t-i} + \\varepsilon_t \\hspace{0.3cm} t=min(p, q) + 1, min(p, q) + 2,\\ldots,n. \\end{align*}\\] A estrutura do modelo ARMA(p, q) tem p termos auto-regressivos, que representam a ordem de defasagens do termo auto-regressivo; e q termos de médias móveis, sendo que este representa a ordem de defasagens do termo de médias móveis. Os modelos descritos anteriormente funcionam para séries estacionárias, porém, na prática a grande maioria das séries são não-estacionárias. Desta forma, estas séries precisam ser defasadas para atingir a condição de estacionariedade, processo também definido como diferenciação, assim, o número de defasagens d necessárias para a obtenção da estacionariedade determinará o grau de integração da variável (Pinto et al. (2008)). Ou seja, uma série inicialmente não-estacionária deverá ser defasada d vezes até atingir uma forma estacionária. Para relizar a defasagem na série é necessário definir o operador de defasagem (LAG): \\[ L^n y_t = y_{t-n}, \\hspace{0.3cm} \\text{em que } t &gt; n. \\] A série defasada \\(n\\) vezes pode ser denotada por: \\[ (1 - L)^n y_t = y_{t} - \\sum_{i=1}^{n} y_{t-i}. \\] Assim como os modelos ARMA, o modelo ARIMA possuí termos AR e MA. Os termos auto-regressivos correspondem a defasagens da série transformada (isto é, série estacionária obtida por diferenciação) e as médias móveis a defasagens dos erros aleatórios. O termo “integrado” refere-se ao processo de diferenciação da série original para torná-la estacionária (Resende (2016)). O modelo ARIMA de ordem p, d e q, denotado por ARIMA(p, d, q), é dado por: \\[\\begin{align*} (1 - L)^dY_{t} = c + \\sum_{i=1}^{p}\\phi_i(1 - L)^dY_{t-i} + \\sum_{j=1}^{q} \\theta_j\\epsilon_{t-j} + \\varepsilon_t \\hspace{0.3cm} t &lt; d, d \\leq p \\text{ e } d \\leq q. \\end{align*}\\] A estimação dos parâmetros de qualquer um dos modelos apresentados pode ser feita através do método de máxima verossimilhança, substituindo termo de erro para o modelo em questão. De forma geral, a equação que fornece os estimadores é: \\[\\begin{equation*} \\mathop{\\mathrm{argmax}}\\limits_{\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}} \\in \\Theta} L(\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}}) = (2\\pi)^{-n/2} (\\sigma_\\varepsilon)^{-n} exp \\left (-\\sum_{t=d+1}^{n} \\frac{{\\varepsilon_t}^2}{2{\\sigma_\\varepsilon^2}}\\right) \\end{equation*}\\] em que \\(\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}}\\) é o vetor de estimadores dos parâmetros do modelo e \\(\\varepsilon_t\\) é o termo de erro do modelo. Em geral, é utilizado algum método numérico de maximização de funções para obtenção do vetor \\(\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}}\\). Para obter o intervalo de previsão para \\(\\hat{y}_{t+\\tau}\\), fazemos: \\[\\begin{equation*} \\hat{y}_{t+\\tau} \\pm z_{\\alpha/2} \\sqrt{\\hat{Var}(\\hat{y}_{t+\\tau})} \\end{equation*}\\] em que \\(z_{\\alpha/2}\\) é o quantil da distribuição Normal que fornece \\(1-\\frac{\\alpha}{2}\\%\\) de confiança. Caso \\({\\sigma_\\varepsilon^2}\\) seja desconhecido, devemos estimá-lo e a distribuição exata será \\(T\\) com \\(n-p+q\\) graus de liberdade, contudo, assintóticamente, a distribuição ainda será Normal. Os intervalos de confiança para os parâmetros e valores ajustados são construídos de forma similar. É importante mencionar que o método de estimação apresentado só é válido quando os erros têm distribuição normal com variância constante. Em casos que isso não seja verificado, a estimação pode ser feita utilizando o método dos momento ou o método de mínimos quadrados. Para mais detalhes sobre esses métodos, recomendamos a leitura de Hamilton (1994). Para a escolha do melhor modelo, pode-se ajustar diversos modelos aos dados e usar como critério o AIC (Akaike Information Criteria). Basicamente pode-se traduzir como a estimativa da informação perdida quando um modelo é usado para representar o processo que gerou os dados. A definição mais comumente utilizada é: \\[ AIC = -2l(\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}}; \\boldsymbol{\\mathbf{y}}) + 2p. \\] onde \\(p\\) é o número de parâmetros do modelo e \\(l(\\boldsymbol{\\mathbf{\\hat{\\Upsilon}}}; \\boldsymbol{\\mathbf{y}})\\) é a moda da função log-verossimilhança. O AIC pode assumir quaisquer valores, mesmo negativos, já que dependem da função de verossimilhança. Em uma comparação entre os modelos, o menor valor de AIC pode ser um meio de seleção, ou seja, quando menor o AIC, menor a perda de informações. "],["dados.html", "3 Modelagem com dados reais", " 3 Modelagem com dados reais Muitos dados, gaussianos ou não, podem ser modelados através dos métodos apresentados na seção 2. Nessa seção vamos considerar a temperatura média anual, em graus Fahrenheit, do Central Park, em Nova Iorque. Todas as análises feitas nessa seção foram feitas com a utilização do software R R Core Team (2020) e do pacote forecast (Hyndman et al. (2020); Hyndman and Khandakar (2008)). Figura 3.1: Série temporal da temperatura média anual (em graus Fahrenheit) no Central Park dos anos de 1869 até 2019. A base de dados contém as temperaturas médias anuais de 1869 até 2019, totalizando 151 observações. A Figura 3.1 mostra a tempertura média ao longo dos anos. A Figura 3.2 mostra a série diferenciada uma vez. Para checar a hipótese de estacionaridade, realizamos um teste de Kwiatkowski–Phillips–Schmidt–Shin (KPSS) Kwiatkowski et al. (1992). Com 99% de confiança, o teste mostrou que a série não é estacionária e passa a ser estacionária logo na primeira diferenciação, como pode ser visto no Código 3.1. A autocorrelação dos dados e da primeira diferença estão na Figura 3.3. Código 3.1 Teste KPSS ## Lê o conjunto de dados dd &lt;- data.table::fread(&quot;monthly.csv&quot;) ## Converte para ts serie &lt;- ts(dd$ANNUAL[-152], start = 1869, end = 2019) ## Os dados são estacionários? summary(urca::ur.kpss(serie)) ## ## ####################### ## # KPSS Unit Root Test # ## ####################### ## ## Test is of type: mu with 4 lags. ## ## Value of test-statistic is: 2.5848 ## ## Critical value for a significance level of: ## 10pct 5pct 2.5pct 1pct ## critical values 0.347 0.463 0.574 0.739 summary(urca::ur.kpss(diff(serie))) ## ## ####################### ## # KPSS Unit Root Test # ## ####################### ## ## Test is of type: mu with 4 lags. ## ## Value of test-statistic is: 0.0179 ## ## Critical value for a significance level of: ## 10pct 5pct 2.5pct 1pct ## critical values 0.347 0.463 0.574 0.739 Figura 3.2: Série temporal da temperatura média anual (em graus Fahrenheit) no Central Park dos anos de 1869 até 2019 com um nível de defasagem. Figura 3.3: Diferentes valores de defasagem de autocorrelação da série original (esq.) e para a primeira diferença da série histórica (dir.). Tabela 3.1: Diferentes valores de AIC e parâmetros estimados para cada modelo ARIMA. Modelo AIC ĉ θ̂ ϕ̂ ARIMA(0,0,0) 590.84 53.97 ARIMA(0,0,1) 556.85 53.96 0.39 ARIMA(0,1,0) 553.88 ARIMA(1,0,0) 528.15 53.96 0.59 ARIMA(0,1,1) 481.78 -0.86 ARIMA(1,0,1) 489.63 53.87 -0.85 0.99 ARIMA(1,1,0) 518.51 -0.47 ARIMA(1,1,1) 483.28 -0.87 0.06 A Tabela 3.1 mostra o AIC e os parâmetros estimados de cada modelo ajustado por máxima verossimilhança aos dados. O modelo que melhor se ajustou foi ARIMA(0, 1, 1), com \\(\\hat{\\sigma}^2\\) = 1.4 e \\(\\hat{Var}(\\hat{\\theta}) = 0.0016\\). Portanto, a equação do modelo ajustado é dada por: \\[\\begin{equation*} \\hat{Y}&#39;_t = -0.8561 (\\hat{Y}_{t-1} - Y_{t-1}) \\hspace{0.3cm} \\text{com } t = 2, 3, \\ldots, 151. \\end{equation*}\\] A Figura 3.4 mostra os resíduos do modelo ajustado. O resíduo apresenta padrão aleatório e não há valores extremos, indicando que não temos problemas com falta de ajuste, também, notamos que não há relação entre média e variância. A Figura 3.5 mostra que não temos problemas de resíduos autocorrelacionados. Os resíduos também se aderem à distribuição Normal, porém com caudas mais leves, como pode ser visto na Figura 3.6. Figura 3.4: Resíduos (acima) e raíz quadrada do valor absoluto dos resíduos padronizados para cada valor ajustado pelo modelo ARIMA(0,1,1). Figura 3.5: Autocorrelação dos resíduos para diferentes valores de defasagem ajustados pelo modelo ARIMA(0,1,1). Figura 3.6: Gráfico quantil-quantil dos resíduos ajustados pelo modelo ARIMA(0,1,1). Para finalizar, a Figura 3.7 mostra a série com o intervalo com 95% de confiança para cada valor ajustado e um intervalo de predição com 95% de confiança para os anos de 2020 a 2024. Como o modelo ajustado desconsiderou os valores da parte auto-regressiva, a estimativa pontual é constante para a predição. Figura 3.7: Gráfico da temperatura média anual (em graus Fahrenheit) do Central Park observada (preto) e ajustada (vermelho) pelo modelo ARIMA(0,1,1). Em azul está o intervalo de confiança e o intervalo de predição de 2020 até 2024 (ambos com 95% de confiança). "],["conclusão.html", "4 Conclusão", " 4 Conclusão Nesse trabalho, apresentamos vários modelos para dados com dependência temporal. Há, ainda, diversos outros modelos para as séries temporais que lidam com sazonalidade nos valores observados, modelos para séries temporais multivariadas entre outros problemas. Com esse estudo pode-se afirmar que as séries temporais podem ser utilizadas para descrever um processo estocástico, como a variação da média anual da temperatura de Central Park. Dentre os modelos testados, o que melhor se ajustou aos dados foi o ARIMA (0,1,1), com o menor AIC dentre eles. A previsão da temperatura média anual dos anos de 2020 a 2024 foi feita com esse modelo ajustado e, apesar de os valores terem mostrado uma tendencia ascendente de 1869 a 2019, a previsão mostra uma estabilização da temperatura em relação a 2019. "],["bibliografia.html", "Bibliografia", " Bibliografia "]]
